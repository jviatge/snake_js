<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Mini jeux</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='style.css'>
</head>
<body>
    <script>
        let move;
    </script>
    <script type="text/javascript">

        function bloc_spawn_y(){
            let bloc = document.getElementById("bloc_1");
           
            if(bloc.style.display == "" ||bloc.style.display == "none" ){     
                bloc.style.display = "inline-block";
            } 


            let y = 40 * (Math.floor(Math.random() * (18 - 0 + 1)) + 0);

            bloc.style.top = y + "px";

            return bloc.style.top;
        }

        function bloc_spawn_x(){
            let bloc = document.getElementById("bloc_1");
           
            if(bloc.style.display == ""){               
                bloc.style.display = "inline-block";
            } 

            let x = 40 * (Math.floor(Math.random() * (18 - 0 + 1)) + 0);
            //console.log(x);

            bloc.style.left = x + "px";

            return bloc.style.left;
        }







        function move_top(){
            let player_1 = document.getElementById("player_1");
            let position_style =  player_1.style.top;
            let position = parseFloat(position_style);
                if(Number.isInteger(position)){
                    let total_pos = position - 40;  
                    if(total_pos < 0){
                        player_1.style.top = "720px";
                    } else {
                        player_1.style.top = total_pos + "px";
                    }
                } else {
                   player_1.style.top = 320 + "px";
                }
                return player_1.style.top;
            }

        function move_left(){
        let player_1 = document.getElementById("player_1");
        let position_style =  player_1.style.left;
        let position = parseFloat(position_style);
            if(Number.isInteger(position)){
                let total_pos = position - 40;
                if(total_pos < 0){
                    player_1.style.left = "720px";  
                } else {
                    player_1.style.left = total_pos + "px";
                }
            } else {
                player_1.style.left = 320 + "px";
            }
            return player_1.style.left;
        }

        function move_bottom(){
            let player_1 = document.getElementById("player_1");
            let position_style =  player_1.style.top;
            let position = parseFloat(position_style);
                if(Number.isInteger(position)){
                    let total_pos = position + 40;
                    if(total_pos > 720){
                        player_1.style.top = "0px";
                    } else {
                        player_1.style.top = total_pos + "px";
                    }
                } else {
                    player_1.style.top = 400 + "px";
                }

            return player_1.style.top;
            }

        function move_right(){
            let player_1 = document.getElementById("player_1");
            let position_style =  player_1.style.left;
            let position = parseFloat(position_style);
                if(Number.isInteger(position)){
                    let total_pos = position + 40;
                    if(total_pos > 720){
                        player_1.style.left = "0px";    
                    } else {
                        player_1.style.left = total_pos + "px";
                    }
                } else {
                    player_1.style.left = 400 + "px";
                }
                return player_1.style.left;
            }





        

        
        
        function regroup_bottom(){  
            //let frame = document.getElementById("frame_game");
            let bloc = document.getElementById("bloc_1");
            let player_1 = document.getElementById("player_1");

            let x_p = move_bottom();
            let y_p = player_1.style.left;

            let x = bloc.style.top;
            let y = bloc.style.left;

            if(y_p == y && x_p == x){
                heat_bloc();
            }
        }
        function regroup_top(){  
            //let frame = document.getElementById("frame_game");
            let bloc = document.getElementById("bloc_1");
            let player_1 = document.getElementById("player_1");

            let x_p = move_top();
            let y_p = player_1.style.left;

            let x = bloc.style.top;
            let y = bloc.style.left;

            if(y_p == y && x_p == x){             
                heat_bloc();
            }
        }
        function regroup_right(){  
            //let frame = document.getElementById("frame_game");
            let bloc = document.getElementById("bloc_1");
            let player_1 = document.getElementById("player_1");

            let y_p = move_right();
            let x_p = player_1.style.top;

            let x = bloc.style.top;
            let y = bloc.style.left;

            if(y_p == y && x_p == x){
                heat_bloc();
            } 
        }
        function regroup_left(){  
            //let frame = document.getElementById("frame_game");
            let bloc = document.getElementById("bloc_1");
            let player_1 = document.getElementById("player_1");

            let y_p = move_left();
            let x_p = player_1.style.top;

            let x = bloc.style.top;
            let y = bloc.style.left;

            if(y_p == y && x_p == x){
                heat_bloc();
            }
        }

        function heat_bloc(){
            //let player_1 = document.getElementById("player_1");

            let bloc = document.getElementById("bloc_1");
            let score = document.getElementById("score");
            let total = score.textContent;
            total++;
            score.textContent = total;
            bloc.style.display = "none";

            //player_1.createElement('div').setAttribute("id", "ok");

            console.log("ok");
        }

        

    </script>

    <div id="frame_game">
        <div class="bloc" id="bloc_1"></div>
        <div id="player_1"></div> 
    </div>
    <div class="score">
        <p>SCORE :</p>
        <span id="score">0</span>
    </div>

    <script type="text/javascript">
    
        setInterval(bloc_spawn_y, 5200);
        setInterval(bloc_spawn_x, 5200);

        document.addEventListener('keypress', function(event){
                  
            //console.log(event.which, String.fromCharCode(event.which));
            
            let key = event.which;
            switch(key){
                
                case 115:
                    clearInterval(move);
                    move = setInterval(regroup_bottom, 300);
                    
                    //console.log(bottom);
                    //bottom = move_bottom();
                break;

                case 122:
                    clearInterval(move);
                    move = setInterval(regroup_top, 300);
                break;


                case 100:
                    clearInterval(move);
                    move = setInterval(regroup_right, 300);
                break;


                case 113:
                    clearInterval(move);
                    move = setInterval(regroup_left, 300);
                break;
            
            }

        });
    </script>
</body>
</html>
